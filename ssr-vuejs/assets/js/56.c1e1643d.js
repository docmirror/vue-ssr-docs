(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{168:function(t,e,n){"use strict";n.r(e);var s=n(0),a=Object(s.a)({},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),n("p",[t._v("This is straightforward, however whenever you edit your app source code, you would have to stop and restart the server. This hurts productivity quite a bit during development. In addition, Node.js doesn't support source maps natively.")]),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),n("ul",[t._m(6),t._v(" "),t._m(7),t._v(" "),n("li",[n("p",[t._v("Critical CSS injection (when using "),n("code",[t._v("*.vue")]),t._v(" files): automatically inlines the CSS needed by components used during the render. See the "),n("router-link",{attrs:{to:"./css.html"}},[t._v("CSS")]),t._v(" section for more details.")],1)]),t._v(" "),n("li",[n("p",[t._v("Asset injection with "),n("router-link",{attrs:{to:"./../api/#clientmanifest"}},[t._v("clientManifest")]),t._v(": automatically infers the optimal preload and prefetch directives, and the code-split chunks needed for the initial render.")],1)])]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v("We will discuss how to configure webpack to generate the build artifacts needed by the bundle renderer in the next section, but for now let's assume we already have what we need, and this is how to create and use a bundle renderer:")]),t._v(" "),t._m(8),t._m(9),t._v(" "),n("p",[t._v("Note it's recommended to set the "),n("code",[t._v("runInNewContext")]),t._v(" option to "),n("code",[t._v("false")]),t._v(" or "),n("code",[t._v("'once'")]),t._v(". See its "),n("router-link",{attrs:{to:"./../api/#runinnewcontext"}},[t._v("API reference")]),t._v(" for more details.")],1)])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"introducing-bundle-renderer"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#introducing-bundle-renderer","aria-hidden":"true"}},[this._v("#")]),this._v(" Introducing Bundle Renderer")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"problems-with-basic-ssr"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#problems-with-basic-ssr","aria-hidden":"true"}},[this._v("#")]),this._v(" Problems with Basic SSR")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Up to this point, we have assumed that the bundled server-side code will be directly used by the server via "),e("code",[this._v("require")]),this._v(":")])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" createApp "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("require")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'/path/to/built-server-bundle.js'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"enter-bundlerenderer"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#enter-bundlerenderer","aria-hidden":"true"}},[this._v("#")]),this._v(" Enter BundleRenderer")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("vue-server-renderer")]),this._v(" provides an API called "),e("code",[this._v("createBundleRenderer")]),this._v(" to deal with this problem. With a custom webpack plugin, the server bundle is generated as a special JSON file that can be passed to the bundle renderer. Once the bundle renderer is created, usage is the same as the normal renderer, however the bundle renderer provides the following benefits:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("p",[this._v("Built-in source map support (with "),e("code",[this._v("devtool: 'source-map'")]),this._v(" in webpack config)")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("p",[this._v("Hot-reload during development and even deployment (by simply reading the updated bundle and re-creating the renderer instance)")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" createBundleRenderer "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("require")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'vue-server-renderer'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" renderer "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("createBundleRenderer")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("serverBundle"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  runInNewContext"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token boolean"}},[t._v("false")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("// recommended")]),t._v("\n  template"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("// (optional) page template")]),t._v("\n  clientManifest "),n("span",{attrs:{class:"token comment"}},[t._v("// (optional) client build manifest")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{attrs:{class:"token comment"}},[t._v("// inside a server handler...")]),t._v("\nserver"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'*'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" context "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" url"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" req"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{attrs:{class:"token comment"}},[t._v("// No need to pass an app here because it is auto-created by")]),t._v("\n  "),n("span",{attrs:{class:"token comment"}},[t._v("// executing the bundle. Now our server is decoupled from our Vue app!")]),t._v("\n  renderer"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("renderToString")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" html"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// handle error...")]),t._v("\n    res"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("end")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("html"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("When "),e("code",[this._v("renderToString")]),this._v(" is called on a bundle renderer, it will automatically execute the function exported by the bundle to create an app instance (passing "),e("code",[this._v("context")]),this._v(" as the argument) , and then render it.")])}],!1,null,null,null);a.options.__file="bundle-renderer.md";e.default=a.exports}}]);